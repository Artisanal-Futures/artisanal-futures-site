model Shop {
  id            String       @id @default(cuid())
  ownerName     String
  bio           String?
  description   String?
  ownerPhoto    String?
  logoPhoto     String?
  coverPhoto    String?
  phone         String?
  email         String
  website       String?
  ownerId       String
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  attributeTags String[]
  name          String
  products      Product[]
  services      Service[]
  owner         User         @relation(fields: [ownerId], references: [id], onDelete: NoAction)
  address       ShopAddress?
  websiteProvision WebsiteProvision? @relation("ShopWebsiteProvision") 
}

model ShopAddress {
  id         String  @id @default(cuid())
  address    String?
  additional String?
  city       String?
  state      String?
  zip        String?
  country    String?
  shopId     String? @unique
  shop       Shop?   @relation(fields: [shopId], references: [id], onDelete: Cascade)
  street     String?
}

model Service {
  id                String     @id @default(cuid())
  name              String
  description       String
  priceInCents      Int?
  currency          String?
  imageUrl          String?
  durationInMinutes Int?
  locationType      String?
  tags              String[]
  attributeTags     String[]
  aiGeneratedTags   String[]
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
  isPublic          Boolean    @default(false)
  shopId            String?
  isFeatured        Boolean    @default(false)
  serviceUrl        String?
  shop              Shop?      @relation(fields: [shopId], references: [id], onDelete: Cascade)
  categories        Category[] @relation("CategoryToService")
}

model Product {
  id                String              @id @default(cuid())
  shopProductId     String?
  name              String
  description       String
  priceInCents      Int?
  currency          String?
  imageUrl          String?
  productUrl        String?
  attributeTags     String[]
  materialTags      String[]
  environmentalTags String[]
  aiGeneratedTags   String[]
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  scrapeMethod      ProductScrapeMethod @default(MANUAL)
  shopId            String?
  tags              String[]
  isPublic          Boolean             @default(false)
  isFeatured        Boolean             @default(false)
  shop              Shop?               @relation(fields: [shopId], references: [id], onDelete: Cascade)
  categories        Category[]          @relation("CategoryToProduct")

  @@unique([shopId, shopProductId])
}

model Category {
  id       String       @id @default(cuid())
  name     String       @unique
  parentId String?
  type     CategoryType @default(PRODUCT)
  parent   Category?    @relation("Subcategories", fields: [parentId], references: [id], onDelete: NoAction)
  children Category[]   @relation("Subcategories")
  products Product[]    @relation("CategoryToProduct")
  services Service[]    @relation("CategoryToService")
}

enum CategoryType {
  PRODUCT
  SERVICE
}

enum ProductScrapeMethod {
  MANUAL
  WORDPRESS
  SHOPIFY
  SQUARESPACE
}
